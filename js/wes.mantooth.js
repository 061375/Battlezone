function detectIE(){var a=window.navigator.userAgent,b=a.indexOf("MSIE ");if(b>0)return parseInt(a.substring(b+5,a.indexOf(".",b)),10);var c=a.indexOf("Trident/");if(c>0){var d=a.indexOf("rv:");return parseInt(a.substring(d+3,a.indexOf(".",d)),10)}var e=a.indexOf("Edge/");return e>0?parseInt(a.substring(e+5,a.indexOf(".",e)),10):!1}var $w={boolLog:!1,objects:{},killobjects:{},noloop:{},looprunning:!0,inits:{},refs:[],hasdepth:[],gamespeed:0,global:{},assets:{img:[],audio:[],midi:[],scripts:[],link:[]},main:{width:0,height:0},log:function(a){this.boolLog&&void 0!==window.console&&console.log(a)},slocation:function(){for(var a=document.getElementsByTagName("script"),b=a.length,c="",d=0;b>d;d++)a[d].src.indexOf("wes.mantooth.js")>-1&&(c=a[d].src,c=c.replace(c.substr(c.indexOf("wes.mantooth.js"),c.length),""),c=c.replace("components/",""));return c},makeFPS:function(a){"undefined"==typeof a&&(a=!0),a=a?"show":"";var b=document.createElement("style");b.innerHTML="#wm_show_fps{background: #000;z-index: 999999;width: 100px;height: 80px;position: absolute;color: #ffff00;right: 0;top: 0;padding: 5px;display:none;}#wm_show_fps.show{display:block}",document.getElementsByTagName("head")[0].appendChild(b);var c=document.createElement("div");c.setAttribute("id","wm_show_fps"),c.setAttribute("class",a),document.getElementsByTagName("body")[0].appendChild(c)},upFPS:function(a){"undefined"==typeof a&&(a=document.getElementById("wm_show_fps")),a.innerHTML=countFPS()+" fps"},loop:function(a,b,c){"undefined"==typeof b||isNaN(b)||$w.canvas.clear(b),("undefined"!=typeof c||c)&&$w.upFPS();for(var d in this.objects)if(this.objects.hasOwnProperty(d)){for(var e=this.objects[d].length,f=0;e>f;f++)null!=this.objects[d][f]&&this.objects[d][f].loop();if($w.hasdepth.indexOf(d)>-1)for(var f=0;e>f;f++)if(null!=this.objects[d][f]&&"undefined"!=typeof this.objects[d][f].z){var g=this.objects[d].splice(f,1);this.objects[d].splice(g[0].z,0,g[0])}}a&&$w.looprunning&&window.setTimeout(function(){window.requestAnimationFrame(function(){$w.loop(a,b,c)})},$w.gamespeed),$w.kill_players()},clearloop:function(){$w.looprunning=!1},obj_set_var:function(a,b,c,d){if(this.objects.hasOwnProperty(a))for(var e=this.objects[a].length,f=0;e>f;f++)null!=this.objects[a][f]&&(this.objects[a][f][b]=c);"function"==typeof d&&d()},obj_run_method:function(a,b,c,d){if(this.objects.hasOwnProperty(a))for(var e=this.objects[a].length,f=0;e>f;f++)null!=this.objects[a][f]&&"function"==typeof this.objects[a][f][b]&&this.objects[a][f][b](c);"function"==typeof d&&d()},kill_players:function(){for(var a in this.killobjects)if(this.killobjects.hasOwnProperty(a))for(var b=this.killobjects[a].length,c=0;b>c;c++)this.objects[a][this.killobjects[a][c]]=null},add_object:function(a,b,c,d,e,f,g){return $w.game.add_object(a,b,c,d,e,f,g)},add_object_single:function(a,b,c,d,e,f,g){return $w.game.add_object_single(a,b,c,d,e,f,g)},remove_object:function(a,b){return $w.game.remove_object(a,b)},kill_player:function(a,b){void 0===this.killobjects[a]&&(this.killobjects[a]=[]),this.killobjects[a].push(b)},all:function(a,b,c,d){for(var e=a.length,f=0;e>f;f++)d.i=f,$w.objects[b][f][c](d)}};$w.buttons=function(){"use strict";function a(a,c,d,e,f,g,h,i,j){var k=c,l=d,m=document.getElementsByTagName("canvas")[a],n=m.documentOffsetLeft,o=m.documentOffsetTop,p=n+c,q=o+d;"undefined"!=typeof h.text.padding&&(k+=h.text.padding,l+=h.text.padding),$w.canvas.roundRectangle(a,c,d,e,f,g,h.button.color,h.button.fill,h.button.acolor,h.button.opacity),$w.canvas.text(a,k,l,i,h.text.fill,h.text.font,h.text.color),"undefined"!=typeof j&&($w.mouse.trackMouse(m,function(m){if("function"==typeof j.hover)if(m.x>p&&m.x<p+e&&m.y>q&&m.y<q+f){$w.canvas.roundRectangle(a,c,d,e,f,g,h.button.hcolor,h.button.fill,h.button.acolor,h.button.opacity);var n=h.text.color;"undefined"!=typeof h.text.hcolor&&(n=h.text.hcolor),$w.canvas.text(a,k,l,i,h.text.fill,h.text.font,n),b||(b=!0,j.hover())}else $w.canvas.roundRectangle(a,c,d,e,f,g,h.button.color,h.button.fill,h.button.acolor,h.button.opacity),$w.canvas.text(a,k,l,i,h.text.fill,h.text.font,h.text.color),b=!1}),"function"==typeof j.click&&document.addEventListener("click",function(a){a.clientX>p&&a.clientX<p+e&&a.clientY>q&&a.clientY<q+f&&j.click()}))}var b=!1;return{pill:a}}(),$w.canvas=function(){"use strict";var a,b=!1,c=[],d="12px serif",e="#000000",f="#e6e6e6",g=1,h=[],i=function(d,e,f,g){"undefined"==typeof d&&(d=document.getElementsByTagName("body")[0]),"undefined"==typeof e&&(e=window.innerWidth),"undefined"==typeof f&&(f=window.innerHeight),a=document.createElement("canvas"),a.setAttribute("hidpi","no"),a.setAttribute("width",e),a.setAttribute("height",f),a.setAttribute("style","z-index:"+(c.length+1)),a.setAttribute("id","c"+c.length),d.appendChild(a),a.width=a.offsetWidth,a.height=a.offsetHeight,a.style.width=a.width+"px",a.style.height=a.height+"px";var h=c.length;return c.push(a.getContext("2d")),b=!0,"function"==typeof g&&g(h),h},j=function(a,b,d,f,g,h,i,j){"undefined"==typeof j&&(b=~~b,d=~~d),0>f&&(f=1e-5),"undefined"==typeof g&&(g=e),"undefined"!=typeof h&&(c[a].globalAlpha=h),c[a].fillStyle=g,c[a].beginPath(),c[a].arc(b,d,f,0,2*Math.PI,!0),c[a].closePath(),void 0===i||0==i?c[a].fill():c[a].stroke()},k=function(a,b,d,f,g,h,i,j,k){"undefined"==typeof k&&(b=~~b,d=~~d),"undefined"==typeof j&&(j=e),c[a].beginPath(),c[a].strokeStyle=j,c[a].arc(b,d,f,g,h,i),c[a].stroke()},l=function(a,b,d,f,g,h,i,j,k){"undefined"==typeof k&&(b=~~b,d=~~d,f=~~f,g=~~g,h=~~h,i=~~i),"undefined"==typeof j&&(j=e),c[a].beginPath(),c[a].strokeStyle=j,c[a].moveTo(b,d),c[a].quadraticCurveTo(f,g,h,i),c[a].stroke()},m=function(a,b,d,f,g,h,i,j,k,l,m){"undefined"==typeof m&&(b=~~b,d=~~d,f=~~f,g=~~g,h=~~h,i=~~i,j=~~j,k=~~k),"undefined"==typeof l&&(l=e),c[a].beginPath(),c[a].strokeStyle=l,c[a].moveTo(b,d),c[a].bezierCurveTo(f,g,h,i,j,k),c[a].stroke()},n=function(a,b,e,f,g,h,i,j){$w.log("$w.text("+[a,b,e,f,g,h,i,j]+")"),"undefined"==typeof j&&(b=~~b,e=~~e),"undefined"==typeof h&&(h=d),"undefined"==typeof g&&(g="fill"),"undefined"!=typeof h&&(c[a].strokeStyle=i,c[a].fillStyle=i),c[a].font=h,"fill"==g?c[a].fillText(f,b,e):c[a].strokeText(f,b,e)},o=function(a,b,d,f,h,i,j,k){"undefined"==typeof k&&(b=~~b,d=~~d,f=~~f,h=~~h),"undefined"==typeof i&&(i=e),"undefined"==typeof j&&(j=g),c[a].beginPath(),c[a].moveTo(b,d),c[a].lineTo(f,h),c[a].lineWidth=j,c[a].strokeStyle=i,c[a].stroke(),c[a].closePath()},p=function(a,b,d,e,f,g,h,i,j,k){switch("undefined"==typeof k&&(b=~~b,d=~~d,e=~~e,f=~~f),"undefined"==typeof h&&(h="stroke"),h){case"fill":c[a].fillStyle=g,"undefined"!=typeof j&&(c[a].globalAlpha=j),c[a].fillRect(b,d,e,f);break;case"stroke":c[a].strokeStyle=g,c[a].strokeRect(b,d,e,f);break;default:c[a].fillStyle=i,"undefined"!=typeof j&&(c[a].globalAlpha=j),c[a].fillRect(b,d,e,f),c[a].strokeStyle=g,c[a].strokeRect(b,d,e,f)}},q=function(a,b,d,e,f,g,h,i,j,k){switch(c[a].beginPath(),c[a].moveTo(b,d+g),c[a].lineTo(b,d+f-g),c[a].arcTo(b,d+f,b+g,d+f,g),c[a].lineTo(b+e-g,d+f),c[a].arcTo(b+e,d+f,b+e,d+f-g,g),c[a].lineTo(b+e,d+g),c[a].arcTo(b+e,d,b+e-g,d,g),c[a].lineTo(b+g,d),c[a].arcTo(b,d,b,d+g,g),"undefined"==typeof i&&(i="stroke"),i){case"fill":c[a].fillStyle=h,"undefined"!=typeof k&&(c[a].globalAlpha=k),c[a].fill();break;case"stroke":c[a].strokeStyle=h,c[a].stroke();break;default:c[a].fillStyle=j,"undefined"!=typeof k&&(c[a].globalAlpha=k),c[a].fill(),c[a].strokeStyle=h,c[a].stroke()}c[a].stroke()},r=function(a,b,d,g,h,i,j){switch("undefined"==typeof j&&(j=!1),"undefined"==typeof g&&(g="stroke"),"undefined"==typeof d&&(d=e),"undefined"==typeof h&&(h=f),g){case"fill":c[a].fillStyle=d,"undefined"!=typeof i&&(c[a].globalAlpha=i);break;case"stroke":c[a].strokeStyle=d;break;default:c[a].fillStyle=h,"undefined"!=typeof i&&(c[a].globalAlpha=i),c[a].strokeStyle=d}c[a].beginPath(),c[a].moveTo(b[0][0],b[0][1]);for(var k=b.length,l=1;k>l;l++)c[a].lineTo(b[l][0],b[l][1]);c[a].fill()},s=function(a,b,d,e){return("undefined"==typeof e||e)&&t(a),c[a].save(),"undefined"==typeof d&&(b.sx=Math.floor(b.sx),b.sy=Math.floor(b.sy),b.sWidth=Math.floor(b.sWidth),b.sHeight=Math.floor(b.sHeight),b.dx=Math.floor(b.dx),b.dy=Math.floor(b.dy),b.dWidth=Math.floor(b.dWidth),b.dHeight=Math.floor(b.dHeight)),"undefined"==typeof b.img?(x("image not set"),!1):("undefined"!=typeof b.sWidth&&0!=b.sWidth?c[a].drawImage(b.img,b.sx,b.sy,b.sWidth,b.sHeight,b.dx,b.dy,b.dWidth,b.dHeight):"undefined"!=typeof b.dWidth&&0!=b.dWidth?c[a].drawImage(b.img,b.dx,b.dy,b.dWidth,b.dHeight):c[a].drawImage(b.img,b.dx,b.dy),c[a].restore(),!0)},t=function(b,d){"undefined"==typeof d||d?c[b].clearRect(0,0,a.width,a.height):(c[b].save(),c[b].setTransform(1,0,0,1,0,0),c[b].clearRect(0,0,a.width,a.height),c[b].restore())},u=function(a,b){document.getElementById("c"+a).style.zIndex=~~b},v=function(b,d){switch(d){case"canvas":d=a;break;case"ctx":d=c[b]}return d},w=function(){c.pop()},x=function(a){h.push("Error: "+a)},y=function(){if(h.length>0)for(var a=h.length,b=0;a>b;b++)$w.log(h[b])};return{init:i,circle:j,arc:k,qArc:l,bArc:m,text:n,line:o,image:s,rectangle:p,roundRectangle:q,polygon:r,clear:t,get:v,pop:w,zIndex:u,has_error:y}}(),$w.collision={checkCollision:function(a,b){for(var c=new Array(a.x-a.negXcollisionBox,a.x+a.posXcollisionBox),d=new Array(a.y-a.negYcollisionBox,a.y+a.posYcollisionBox),e=0;2>e;e++)for(var f=0;2>f;f++)if(c[e]>b.x-b.negXcollisionBox&&c[e]<b.x+b.posXcollisionBox&&d[f]>b.y-b.negYcollisionBox&&d[f]<b.y+b.posYcollisionBox)return!0;return!1},checkCollisionCoords:function(a,b,c,d,e){new Array(a-e,a+e),new Array(d-e,d+e);return a>c-e&&c+e>a&&b>d-e&&d+e>b},square:function(a,b,c,d,e,f){},circle:function(a,b){for(var c=a.length,d=0;c>d;d++){var e=$w.motion.distance_to_point(a[d][0],a[d][1],b.x,b.y);if(e-b.radius<0)return!0}return!1},checkCircle:function(a,b,c,d,e,f){var g=$w.motion.distance_to_point(a,b,d,e),h=c+f;return g-h>0},insideCanvas:function(a,b,c){return"undefined"==typeof a&&(a=0),0>b?1:b>$w.canvas.get(a,"canvas").width?3:c>$w.canvas.get(a,"canvas").height?4:0>c?2:0},inside:function(a,b){for(var c=a[0],d=a[1],e=!1,f=0,g=b.length-1;f<b.length;g=f++){var h=b[f][0],i=b[f][1],j=b[g][0],k=b[g][1],l=i>d!=k>d&&(j-h)*(d-i)/(k-i)+h>c;l&&(e=!e)}return e},objectNearest:function(a,b){var c={o:null,d:!1};for(var d in $w.objects)if($w.objects.hasOwnProperty(d))for(var e in $w.objects[d]){var f=$w.objects[d],g=$w.motion.distance_to_point(a,b,f.x,f.y);c.d?g<c.d&&(c.d=g,c.o=f,c.id=e):(c.d=g,c.o=f,c.id=e)}return c}},$w.color={componentToHex:function(a){var b=a.toString(16);return 1==b.length?"0"+b:b},rgbToHex:function(a,b,c){return"#"+this.componentToHex(a)+this.componentToHex(b)+this.componentToHex(c)},random:function(){for(var a=[],b=0;3>b;b++)a.push(~~(255*Math.random()));return $w.color.rgbToHex(a[0],a[1],a[2])}},$w.draw=function(){"use strict";var a=function(a,b,c,d,e,f){$w.log("$w.grid("+[a,b,c,d,e]+")");for(var g=b/(10*d),h=1;b>h;h+=g)$w.canvas.line(a,h,0,h,c,"#dedede");for(var i=1;c>i;i+=g)$w.canvas.line(a,0,i,b,i,"#dedede");("undefined"==typeof e||e)&&($w.canvas.line(a,0,b/2,b,c/2,"#000000",2),$w.canvas.line(a,c/2,0,b/2,c,"#000000",2)),"function"==typeof f&&f()},b=function(a,b,c,d,e,f){$w.log("$w.grid("+[a,b,c,d,e]+")");for(var g=b/(10*d),h=1;b>h;h+=g)$w.canvas.line(a,h,0,h,c,"#dedede");for(var i=1;c>i;i+=g-e)$w.canvas.line(a,0,i,b,i,"#dedede");$w.canvas.line(a,0,b/2,b,c/2,"#000000",2),$w.canvas.line(a,c/2,0,b/2,c,"#000000",2),"function"==typeof f&&f()};return{grid:a,gridp:b}}(),$w.game={map:{},b_keydown:!1,b_keypress:!1,b_keyup:!1,add_object:function(a,b,c,d,e,f,g){for(var h=[],i=0;a>i;i++){var j=$w.canvas.init(d,e,f);c.i=j,c.count=i,"undefined"==typeof g||g?"object"==typeof $w.objects[b.name]?$w.objects[b.name][j]=new b(c):($w.objects[b.name]=[],$w.objects[b.name][j]=new b(c)):"object"==typeof $w.noloop[b.name]?$w.noloop[b.name][j]=new b(c):($w.noloop[b.name]=[],$w.noloop[b.name][j]=new b(c)),h.push(j)}return h},add_object_single:function(a,b,c,d,e,f,g){var h,i,j=!1;"undefined"==typeof g&&(g=!0),h="object"==typeof d?$w.canvas.init(d,e,f):d,"undefined"==typeof $w.objects[b.name]&&($w.objects[b.name]=[],j=!0);var k=$w.objects[b.name].length,l=k+a;for(i=k;l>i;i++)c.i=h,c.count=i,c.z=i,$w.objects[b.name].push(new b(c));if(j&&g)for(var m=a;9999>m;m++)"object"!=typeof $w.objects[b.name][m]&&null!=$w.objects[b.name][m]&&($w.objects[b.name][m]=null);return h},remove_object:function(a,b){$w.objects[a].splice(b,1);var c=document.getElementsByTagName("canvas")[b];"undefined"!=typeof c&&c.parentNode.removeChild(c.parentNode.childNodes[b])},bindkeys:function(a,b,c,d){switch($w.log("Game.key."+b),"undefined"==typeof $w.game.map[b]&&($w.game.map[b]=[]),$w.game.map[b].push(a),"undefined"==typeof c&&(c=document),b){case"keydown":this.b_keydown||(this.b_keydown=!0,c.addEventListener("keydown",function(a){detectIE&&(a.code=$w.keycode[a.keyCode]),$w.game.key(a,b,d)}));break;case"keypress":this.b_keypress||c.addEventListener("keypress",function(a){detectIE&&(a.code=$w.keycode[a.keyCode]),$w.game.key(a,b,d)});break;default:this.b_keyup||c.addEventListener("keyup",function(a){detectIE&&(a.code=$w.keycode[a.keyCode]),$w.game.key(a,b,d)})}},key:function(a,b,c){$w.log("Game.key."+b),$w.log(a);for(var d=$w.game.map[b].length,e=0;d>e;e++){var f=$w.game.map[b][e];for(var g in f)f.hasOwnProperty(g)&&a.code==g&&f[g](a,c)}}},$w.keycode=[],$w.keycode[0]="",$w.keycode[1]="",$w.keycode[2]="",$w.keycode[3]="",$w.keycode[4]="",$w.keycode[5]="",$w.keycode[6]="",$w.keycode[7]="",$w.keycode[8]="Backspace",$w.keycode[9]="Tab",$w.keycode[10]="",$w.keycode[11]="",$w.keycode[12]="",$w.keycode[13]="Enter",$w.keycode[14]="",$w.keycode[15]="",$w.keycode[16]="ShiftLeft",$w.keycode[17]="ControlLeft",$w.keycode[18]="AltLeft",$w.keycode[19]="",$w.keycode[20]="",$w.keycode[21]="",$w.keycode[22]="",$w.keycode[23]="",$w.keycode[24]="",$w.keycode[25]="",$w.keycode[26]="",$w.keycode[27]="Escape",$w.keycode[28]="",$w.keycode[29]="",$w.keycode[30]="",$w.keycode[31]="",$w.keycode[32]="",$w.keycode[33]="",$w.keycode[34]="",$w.keycode[35]="",$w.keycode[36]="",$w.keycode[37]="ArrowLeft",$w.keycode[38]="ArrowUp",$w.keycode[39]="ArrowRight",$w.keycode[40]="ArrowDown",$w.keycode[41]="",$w.keycode[42]="",$w.keycode[43]="",$w.keycode[44]="",$w.keycode[45]="",$w.keycode[46]="",$w.keycode[47]="",$w.keycode[48]="Digit0",$w.keycode[49]="Digit1",$w.keycode[50]="Digit2",$w.keycode[51]="Digit3",$w.keycode[52]="Digit4",$w.keycode[53]="Digit5",$w.keycode[54]="Digit6",$w.keycode[55]="Digit7",$w.keycode[56]="Digit8",$w.keycode[57]="Digit9",$w.keycode[58]="",$w.keycode[59]="",$w.keycode[60]="",$w.keycode[61]="",$w.keycode[62]="",$w.keycode[63]="",$w.keycode[64]="",$w.keycode[65]="KeyA",$w.keycode[66]="KeyB",$w.keycode[67]="KeyC",$w.keycode[68]="KeyD",$w.keycode[69]="KeyE",$w.keycode[70]="KeyF",$w.keycode[71]="KeyG",$w.keycode[72]="KeyH",$w.keycode[73]="KeyI",$w.keycode[74]="KeyJ",$w.keycode[75]="KeyK",$w.keycode[76]="KeyL",$w.keycode[77]="KeyM",$w.keycode[78]="KeyN",$w.keycode[79]="KeyO",$w.keycode[80]="KeyP",$w.keycode[81]="KeyQ",$w.keycode[82]="KeyR",$w.keycode[83]="KeyS",$w.keycode[84]="KeyT",$w.keycode[85]="KeyU",$w.keycode[86]="KeyV",$w.keycode[87]="KeyW",$w.keycode[88]="KeyX",$w.keycode[89]="KeyY",$w.keycode[90]="KeyZ",$w.keycode[91]="",$w.keycode[92]="",$w.keycode[93]="",$w.keycode[94]="",$w.keycode[95]="",$w.keycode[96]="Numpad0",$w.keycode[97]="Numpad1",$w.keycode[98]="Numpad2",$w.keycode[99]="Numpad3",$w.keycode[100]="Numpad4",$w.keycode[101]="Numpad5",$w.keycode[102]="Numpad6",$w.keycode[103]="Numpad7",$w.keycode[104]="Numpad8",$w.keycode[105]="Numpad9",$w.keycode[106]="NumpadMultiply",$w.keycode[107]="NumpadAdd",$w.keycode[108]="",$w.keycode[109]="NumpadSubtract",$w.keycode[110]="NumpadDecimal",$w.keycode[111]="NumpadDivide",$w.keycode[112]="F1",$w.keycode[113]="F2",$w.keycode[114]="F3",$w.keycode[115]="F4",$w.keycode[116]="F5",$w.keycode[117]="F6",$w.keycode[118]="F7",$w.keycode[119]="F8",$w.keycode[120]="F9",$w.keycode[121]="F10",$w.keycode[122]="F11",$w.keycode[123]="F12",$w.gui=function(){"use strict";var a=function(a,b,c){var d=$w.add_object(1,wesDialog,{style:c,m:b},document.getElementById("target"),a.cw,a.ch);$w.objects.wesDialog[d[0]].run(d[0])};return{dialog:a}}();var wesDialog=function(a){this.run=function(b){$w.canvas.rectangle(b,a.style.box.x,a.style.box.y,a.style.box.w,a.style.box.h,a.style.box.color,a.style.box.method,a.style.box.acolor,a.style.box.opacity),$w.canvas.text(b,a.style.text.x+a.style.text.p,a.style.text.y+a.style.text.p,a.m,a.style.text.method,a.style.text.font,a.style.text.color),$w.buttons.pill(b,a.style.box.x+a.style.box.w/2-75,a.style.box.y+a.style.box.h-60,150,30,15,{button:{color:"#ff0000",fill:"fill",acolor:"#000000",opacity:1,hcolor:"#ff0000"},text:{color:"#ffffff",font:"20px Arial",padding:23}},"Close",{hover:function(){$w.log("hover")},click:function(){console.log("clicked"),$w.remove_object("wesDialog",b)}})}};wesDialog.prototype.loop=function(){},$w.loading=function(){"use strict";var a=[],b=[".jpg",".gif",".png",".svg"],c={loaders:["loading1.gif","loading2.gif"],loaded:0,loading:null,timeout:1e4},d=function(a,d,e,f){c.assets_path=$w.slocation()+"../assets/loaders/","undefined"==typeof e&&(e="");var g=document.createElement("div");if(g.setAttribute("class","loader_fader "+e),g.setAttribute("style","width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px"),"undefined"==typeof c.loaders[d]){if(k("selected loader reference does not exist"),"function"!=typeof f)return!1;f(!1)}var h=document.createElement("div");h.setAttribute("class","loader_container "+e),h.setAttribute("style","width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px");var i=/\.[0-9a-z]+$/i;if(b.indexOf(c.loaders[d].match(i)[0])>-1){var j=document.createElement("img");j.setAttribute("src",c.assets_path+c.loaders[d]),h.appendChild(j)}else h.innerHTML=c.loaders[d];return a.appendChild(g),a.appendChild(h),"function"==typeof f&&f(!0),!0},e=function(a,b){var d=Object.keys(a).length,e=0,m=/\.[0-9a-z]+$/i;for(var n in a)if(a.hasOwnProperty(n)){var o=a[n].match(m)[0];switch(o){case".jpg":case".gif":case".png":case".svg":case".bmp":g(a[n],n);break;case".js":case".json":j(a[n],n);break;case".txt":case".css":i(a[n],n);break;case".ogg":case".mp3":h(a[n],n);break;case".midi":break;case".mp4":break;default:k("requested MIME type not supported"),b(!1)}l()}c.loading=setInterval(function(){c.loaded==d&&f(function(){clearInterval(c.loading),b(!0)}),e++,e>=c.timeout&&(k("assets failed to load, process timed out"),b(!1))},100)},f=function(a){$w.log("Loading.complete");for(var b=["loader_fader","loader_container"],c=0;2>=c;c++)for(var d=document.getElementsByClassName(b[c]),e=d.length,f=0;e>f;f++)d[f].parentElement.removeChild(d[f]);a()},g=function(a,b){$w.log("Loading.load_images "+a);var d=new Image;d.src=a,d.onload=function(){$w.assets.img[b]=d,c.loaded++}},h=function(a,b){$w.log("Loading.load_audio "+a);var d=new Audio(a);d.oncanplaythrough=function(){$w.assets.audio[b]=d,c.loaded++}},i=function(a,b){if("undefined"==typeof a.rel)return k("Loading.load_link param l.rel is a required field"),!1;if("undefined"==typeof a.href)return k("Loading.load_link param l.href is a required field"),!1;var d=document.createElement("link");return d.setAttribute("rel",a.rel),d.setAttribute("href",a.href),document.getElementsByName("head").appendChild(d),$w.assets.link[b]=d,c.loaded++,!0},j=function(a,b){if("undefined"==typeof a.src)return k("Loading.load_script param l.src is a required field"),!1;var d=document.createElement("script");return"undefined"!=typeof a.type&&d.setAttribute("type",a.type),"undefined"!=typeof a.integrity&&d.setAttribute("integrity",a.integrity),"undefined"!=typeof a.crossorigin&&d.setAttribute("crossorigin",a.crossorigin),d.setAttribute("src",a.src),document.getElementsByName("head").appendChild(d),$w.assets.script[b]=link,c.loaded++,!0},k=function(b){a.push("Error: "+b)},l=function(){if(a.length>0){for(var b=a.length,c=0;b>c;c++)$w.log(a[c]);return!0}return!1},m=function(a,b){c[a]=b};return{init:d,load:e,setO_val:m,has_error:l}}(),$w.math={radians:function(a){return a*Math.PI/180},degrees:function(a){return 180*a/Math.PI},sqr:function(a){return a*a},dist:function(a,b,c,d){return Math.hypot(c-a,d-b)},frandom:function(a){return~~(Math.random()*a)},isFloat:function(a){return a===+a&&a!==(0|a)},isInt:function(a){return a===+a&&a===(0|a)}},window.countFPS=function(){var a=(new Date).getMilliseconds(),b=1,c=0;return function(){var d=(new Date).getMilliseconds();return a>d?(c=b,b=1):b+=1,a=d,c}}(),$w.motion={distance_to_point:function(a,b,c,d){return Math.hypot(c-a,d-b)},point_direction:function(a,b,c,d,e,f){void 0===f&&(f=0),void 0===e&&(e=!1);var g=c-a,h=d-b,i=Math.atan2(h,g),j=180*i/Math.PI+f;return 0>j&&(j+=360),j>360&&(j-=360),e?i:j},motion_set:function(a,b,c,d){return $w.math.isFloat(c)||(c=$w.math.radians(c)),a+=Math.cos(c)*Math.PI/180*d,b+=Math.sin(c)*Math.PI/180*d,[a,b]}},$w.mouse={mouseX:0,mouseY:0,trackMouse:function(a,b,c){a.addEventListener("mousemove",function(a){this.mouseX=a.clientX,this.mouseY=a.clientY,"function"==typeof b&&b({x:a.clientX,y:a.clientY},c)})},remove:function(a){a.removeEventListener("mouseup",this,!1)}},HTMLElement.prototype.hasClass=function(a){return this.classList?this.classList.contains(a):!!this.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))},HTMLElement.prototype.addClass=function(a){this.classList?this.classList.add(a):this.hasClass(a)||(this.className+=a)},HTMLElement.prototype.removeClass=function(a){if(this.classList)this.classList.remove(a);else if(this.hasClass(a)){var b=new RegExp("(\\s|^)"+a+"(\\s|$)");this.className=this.className.replace(b," ")}},Object.defineProperty(Element.prototype,"documentOffsetTop",{get:function(){return this.offsetTop+(this.offsetParent?this.offsetParent.documentOffsetTop:0)}}),Object.defineProperty(Element.prototype,"documentOffsetLeft",{get:function(){return this.offsetLeft+(this.offsetParent?this.offsetParent.documentOffsetLeft:0)}}),$w.threed={makeA3DPoint:function(a,b,c){var d={x:a,y:b,z:c};return d},make2DPoint:function(a,b,c,d){var e={x:a,y:b,depth:c,scaleRatio:d};return e},Transform3DPointsTo2DPoints:function(a,b,c,d){void 0===d&&(d=1);for(var e,f,g,h,i,j,k,l,m,n=[],o=Math.sin(b.x),p=Math.cos(b.x),q=Math.sin(b.y),r=Math.cos(b.y),s=Math.sin(b.z)*d,t=Math.cos(b.z)*d,u=a.length;u--;){var e=a[u].x,f=a[u].y,g=a[u].z,h=p*f-o*g,i=o*f+p*g,k=r*i-q*e,j=q*i+r*e,l=t*j-s*h,m=s*j+t*h,v=c/(c+k);e=l*v,f=m*v,g=k,n[u]=this.make2DPoint(e,f,-g,v)}return n},convertPointIn3DToPointIn2D:function(a,b){var c=b/(b+a.z);return{x:a.x*c,y:a.y*c}},drawLines:function(a,b,c,d,e,f,g){var h,i=c.length,j=0,k=0,l=0;for(j=0;i>j;j++)for(0==l&&(l=c[0].length),k=0;l>k;k++)0==k?h=c[j][k]:(void 0!==b[h]&&void 0!==b[c[j][k]]&&$w.canvas.line(a,b[h].x+d,b[h].y+e,b[c[j][k]].x+d,b[c[j][k]].y+e,f,g),h=c[j][k])},cP3dto2d:function(a,b,c){var d,e,f=[],g=$w.math.radians(b.d);a.x-=b.x,a.z-=b.y,d=Math.atan2(a.z,a.x),e=4*Math.sqrt(a.x*a.x+a.z*a.z),a.x=Math.cos(d+g)*e+500;var h=b.fov/(b.fov+2*a.z);return f[0]=a.x*h,f[1]=a.y*h,f}};